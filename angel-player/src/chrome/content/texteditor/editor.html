<!DOCTYPE html>
<html lang="en">
<head>
<title>ACE in Action</title>
<style type="text/css" media="screen">
    #editor {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
    }
</style>
</head>
<body>

<div id="editor-defaults" style="display:none">
fib = fn (n):
    n = n - 1
    a = 0
    b = 1
    while n != 0:
        temp = a + b
        a = b
        b = temp
        n = n - 1
    return b
main = fn:
    x = 50
    set_motor (0, 100)
    set_motor (1, 100)
    print (x)
    fib50 = fib (x)
    print (fib50)
</div>
<div id="editor">
</div>

<script src="../tenshi-frontend/javascripts/ace/ace.js" type="text/javascript" charset="utf-8"></script>
<script src="../tenshi-frontend/javascripts/vendor/jquery.js"></script>
<script>
    var editor = ace.edit("editor");
    function get_text() {
        return editor.getValue();
    }

    var exports = {};
    exports.get_text = get_text;

    var require = parent.require;
    if (require !== undefined) {
        var selector = require("selector");
        selector.connect_storage("editor",
                                function() {
                                    // Serialize
                                    return editor.getValue();
                                }, function(obj) {
                                    // Deserialize
                                    if (obj === undefined) {
                                        editor.setValue($("#editor-defaults").text());
                                        return;
                                    }
                                    editor.setValue(obj);
                                });
    }
</script>
</body>
</html>
